<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, landscape=yes">
    <title>HSK 2 Master - XUSFUNCHINESE</title>
    <style>
        :root {
            --primary: #01579b; 
            --accent: #e1f5fe;  
            --gold: #fbc02d;
            --pinyin: #d0021b; 
            --night-sky: radial-gradient(circle at center, #001f3f 0%, #000510 100%);
        }
        
        body { 
            margin: 0; font-family: "Arial Black", "Segoe UI", Tahoma, sans-serif; 
            background: linear-gradient(135deg, #0277bd 0%, #002f6c 100%); 
            height: 100vh; display: flex; flex-direction: column; overflow: hidden; position: relative;
        }

        /* Â∞ÅÈù¢È°µ */
        #cover-page {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--night-sky); z-index: 5000; display: flex;
            flex-direction: column; justify-content: center; align-items: center;
            cursor: pointer; transition: opacity 0.8s ease-out, visibility 0.8s;
        }
        .cover-content { text-align: center; }
        .cover-title { font-size: 7vw; color: white; text-transform: uppercase; margin: 0; }
        .cover-subtitle { font-size: 9vw; color: var(--gold); margin-top: 5px; font-weight: 900; }

        .watermark {
            position: fixed; right: 30px; bottom: 30px; font-size: 28px;
            font-weight: 900; color: rgba(255, 255, 255, 0.2);
            pointer-events: none; z-index: 1000; letter-spacing: 3px;
        }

        header { 
            background: rgba(255,255,255,0.95); padding: 10px 20px; 
            display: flex; justify-content: space-between; align-items: center; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.3); z-index: 100; 
        }
        .nav-btns button { 
            padding: 8px 15px; margin-right: 5px; border-radius: 20px; border: 2px solid var(--primary); 
            cursor: pointer; font-weight: bold; background: white; color: var(--primary);
        }
        .active-mode { background: var(--primary) !important; color: white !important; }

        main { flex: 1; display: flex; padding: 20px; gap: 15px; overflow: hidden; }
        #left-panel { flex: 1; background: white; border-radius: 30px; display: flex; flex-direction: column; align-items: center; justify-content: center; border: 4px solid var(--accent); }
        #right-panel { flex: 1.6; background: white; border-radius: 30px; padding: 30px; display: flex; flex-direction: column; overflow-y: auto; border: 4px solid var(--accent); }

        .sentence-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 4px; margin: 10px 0; }
        .word-unit { display: inline-flex; flex-direction: column; align-items: center; min-width: 45px; }
        .py-text { font-size: 18px; color: var(--pinyin); font-weight: bold; min-height: 22px; }
        .zh-text { font-size: 48px; font-weight: 600; line-height: 1.1; }
        
        .eng-translation { font-size: 24px; color: #444; margin-top: 15px; text-align: center; font-style: italic; border-top: 1px dashed #ddd; padding-top: 10px; width: 100%; }

        #emoji-display { font-size: 120px; margin-bottom: 20px; }
        .option-btn { background: white; border: 2px solid var(--primary); padding: 15px; margin: 8px 0; border-radius: 15px; cursor: pointer; font-size: 20px; width: 100%; font-weight: bold; }
        
        #scroll-view { display: none; width: 100%; overflow-y: auto; padding: 20px; background: white; border-radius: 30px; }
        .list-row { border-bottom: 1px solid var(--accent); padding: 15px; cursor: pointer; display: flex; align-items: center; }
        .list-row:hover { background: #f0faff; }
        .hidden { display: none !important; }
        #timer-display { font-size: 22px; color: #d32f2f; font-weight: bold; margin-right: 15px; }
    </style>
</head>
<body>

<div id="cover-page" onclick="enterApp()">
    <div class="cover-content">
        <h1 class="cover-title">HSK 2 VOCABULARY</h1>
        <div class="cover-subtitle">150 WORDS</div>
        <div style="color:white; margin-top:20px; letter-spacing:3px; font-weight:bold;">TAP TO START</div>
    </div>
</div>

<div class="watermark">XUSFUNCHINESE</div>

<header>
    <div style="display: flex; align-items: center;">
        <div class="nav-btns">
            <button onclick="changeMode('study')" id="btn-study">üìñ Learn</button>
            <button onclick="changeMode('review')" id="btn-review">üîÑ Review</button>
            <button onclick="changeMode('quiz')" id="btn-quiz">‚ö° Quiz</button>
            <button onclick="changeMode('rush')" id="btn-rush">üî• Rush</button>
            <button onclick="changeMode('mistakes')" id="btn-mistakes">‚ùå Error</button>
        </div>
        <div id="mode-instruction" style="font-size: 14px; color: #666; margin-left: 15px; font-style: italic;"></div>
    </div>
    <div style="display: flex; align-items: center;">
        <span id="timer-display" class="hidden">00:30</span>
        <button onclick="changeMode('list')" id="btn-list" style="padding: 8px 15px; border-radius: 20px; border: 2px solid #555; background: white; cursor: pointer; font-weight: bold;">üìú List</button>
        <span style="font-weight: bold; color: var(--primary); margin-left:15px;">Score: <span id="score-val">0</span></span>
    </div>
</header>

<main>
    <div id="main-ui" style="display: flex; width: 100%; gap: 15px;">
        <div id="left-panel">
            <div id="emoji-display">üéì</div>
            <button onclick="speakItem(true)" style="padding: 15px 40px; border-radius: 50px; cursor: pointer; background: var(--primary); color: white; border: none; font-weight: bold; font-size: 20px;">üîä Audio</button>
        </div>
        <div id="right-panel">
            <div id="display-area" style="min-height:220px; display:flex; flex-direction:column; align-items:center; justify-content:center;"></div>
            <div id="hint-box" class="hidden" style="margin-top:20px; text-align:center; background:#fffde7; padding:15px; border-radius:15px; border-left:8px solid var(--gold);"></div>
            <div id="interaction-area" style="margin-top: 20px;"></div>
        </div>
    </div>
    <div id="scroll-view"></div>
</main>

<script>
    const database = [
        ["ÊÇ®", "n√≠n", "you (polite)", "üôá", {cn: "ÊÇ®Â•Ω", py: "n√≠n h«éo", en: "Hello (polite)"}],
        ["ÂÆÉ", "tƒÅ", "it", "üêæ", {cn: "ÂÆÉÊòØÁå´", py: "tƒÅ sh√¨ mƒÅo", en: "It is a cat"}],
        ["Â§ßÂÆ∂", "d√†jiƒÅ", "everyone", "üë®‚Äçüë©‚Äçüëß‚Äçüë¶", {cn: "Â§ßÂÆ∂Â•Ω", py: "d√† jiƒÅ h«éo", en: "Hello everyone"}],
        ["ÊØè", "mƒõi", "every", "üóìÔ∏è", {cn: "ÊØèÂ§©Â≠¶‰π†", py: "mƒõi tiƒÅn xu√© x√≠", en: "Study every day"}],
        ["‰∏∫‰ªÄ‰πà", "w√®ish√©nme", "why", "‚ùì", {cn: "‰∏∫‰ªÄ‰πàÂéª", py: "w√®i sh√©n me q√π", en: "Why go"}],
        ["Èõ∂", "l√≠ng", "zero", "0Ô∏è‚É£", {cn: "‰∫åÈõ∂‰∫å‰∫î", py: "√®r l√≠ng √®r w«î", en: "Year 2025"}],
        ["‰∏§", "li«éng", "two", "‚úåÔ∏è", {cn: "‰∏§‰∏™ËãπÊûú", py: "li«éng g√® p√≠ng gu«í", en: "Two apples"}],
        ["Áôæ", "b«éi", "hundred", "üíØ", {cn: "‰∏ÄÁôæÂùó", py: "y√¨ b«éi ku√†i", en: "One hundred yuan"}],
        ["ÂçÉ", "qiƒÅn", "thousand", "üî¢", {cn: "‰∏ÄÂçÉÂùó", py: "y√¨ qiƒÅn ku√†i", en: "One thousand yuan"}],
        ["Á¨¨‰∏Ä", "d√¨yƒ´", "first", "ü•á", {cn: "Á¨¨‰∏ÄÂêç", py: "d√¨ yƒ´ m√≠ng", en: "First place"}],
        ["Ê¨°", "c√¨", "times", "üîÑ", {cn: "Âéª‰∏âÊ¨°", py: "q√π sƒÅn c√¨", en: "Go three times"}],
        ["‰ª∂", "ji√†n", "piece", "üëï", {cn: "‰∏Ä‰ª∂Ë°£Êúç", py: "y√≠ ji√†n yƒ´ fu", en: "A piece of clothing"}],
        ["Âà´", "bi√©", "don't", "üö´", {cn: "Âà´ËØ¥ËØù", py: "bi√© shu≈ç hu√†", en: "Don't talk"}],
        ["ÈùûÂ∏∏", "fƒìich√°ng", "very", "‚ú®", {cn: "ÈùûÂ∏∏Â•Ω", py: "fƒìi ch√°ng h«éo", en: "Very good"}],
        ["‰πü", "yƒõ", "also", "‚ûï", {cn: "Êàë‰πüÂéª", py: "w«í yƒõ q√π", en: "I am going too"}],
        ["Ëøò", "h√°i", "still", "‚è≥", {cn: "ËøòÊúâÈí±", py: "h√°i y«íu qi√°n", en: "Still have money"}],
        ["ÊúÄ", "zu√¨", "the most", "üîù", {cn: "ÊúÄÂ•ΩÁöÑ", py: "zu√¨ h«éo de", en: "The best one"}],
        ["Áúü", "zhƒìn", "really", "‚ùóÔ∏è", {cn: "ÁúüÊºÇ‰∫Æ", py: "zhƒìn pi√†o liang", en: "Really beautiful"}],
        ["Ê≠£Âú®", "zh√®ngz√†i", "in process", "üé¨", {cn: "Ê≠£Âú®ÂêÉÈ•≠", py: "zh√®ng z√†i chƒ´ f√†n", en: "Currently eating"}],
        ["Â∑≤Áªè", "y«êjƒ´ng", "already", "üèÅ", {cn: "Â∑≤ÁªèÂà∞‰∫Ü", py: "y«ê jƒ´ng d√†o le", en: "Already arrived"}],
        ["‰∏ÄËµ∑", "y√¨q«ê", "together", "ü§ù", {cn: "‰∏ÄËµ∑ÂéªÂêß", py: "y√¨ q«ê q√π ba", en: "Let's go together"}],
        ["ÂÜç", "z√†i", "again", "‚ôªÔ∏è", {cn: "ÂÜçËßÅ", py: "z√†i ji√†n", en: "Goodbye"}],
        ["Â∞±", "ji√π", "at once", "‚ö°", {cn: "ÊàëÂ∞±Êù•", py: "w«í ji√π l√°i", en: "I'll come right away"}],
        ["Âõ†‰∏∫", "yƒ´nw√®i", "because", "üí¨", {cn: "Âõ†‰∏∫ÂæàÂøô", py: "yƒ´n w√®i hƒõn m√°ng", en: "Because I'm busy"}],
        ["ÊâÄ‰ª•", "su«íy«ê", "so", "üëâ", {cn: "ÊâÄ‰ª•‰∏çÂéª", py: "su«í y«ê b√∫ q√π", en: "So I'm not going"}],
        ["ËôΩÁÑ∂", "suƒ´r√°n", "although", "‚õÖ", {cn: "ËôΩÁÑ∂ÂæàÂÜ∑", py: "suƒ´ r√°n hƒõn lƒõng", en: "Although it's cold"}],
        ["‰ΩÜÊòØ", "d√†nsh√¨", "but", "ü§ö", {cn: "‰ΩÜÊòØ‰ªñÂéª", py: "d√†n sh√¨ tƒÅ q√π", en: "But he is going"}],
        ["‰ªé", "c√≥ng", "from", "üìç", {cn: "‰ªéÂåó‰∫¨Êù•", py: "c√≥ng bƒõi jƒ´ng l√°i", en: "Come from Beijing"}],
        ["ÊØî", "b«ê", "compare", "‚öñÔ∏è", {cn: "‰ªñÊØîÊàëÈ´ò", py: "tƒÅ b«ê w«í gƒÅo", en: "He is taller than me"}],
        ["ÂæÄ", "w«éng", "toward", "‚û°Ô∏è", {cn: "ÂæÄÂ∑¶Ëµ∞", py: "w«éng zu«í z«íu", en: "Go left"}],
        ["Á¶ª", "l√≠", "away from", "üìè", {cn: "Á¶ªÂÆ∂ÂæàËøë", py: "l√≠ jiƒÅ hƒõn j√¨n", en: "Very close to home"}],
        ["Âæó", "de", "particle", "‚öôÔ∏è", {cn: "Ë∑ëÂæóÂø´", py: "p«éo de ku√†i", en: "Run fast"}],
        ["ÁùÄ", "zhe", "particle", "üß•", {cn: "ÁúãÁùÄÊàë", py: "k√†n zhe w«í", en: "Looking at me"}],
        ["Ëøá", "gu√≤", "passed", "üéûÔ∏è", {cn: "ÊàëÂéªËøá", py: "w«í q√π guo", en: "I have been there"}],
        ["Âêß", "ba", "suggestion", "üí¨", {cn: "Ëµ∞Âêß", py: "z«íu ba", en: "Let's go"}],
        ["Êú∫Âú∫", "jƒ´ch«éng", "airport", "‚úàÔ∏è", {cn: "ÂéªÊú∫Âú∫", py: "q√π jƒ´ ch«éng", en: "Go to airport"}],
        ["ÊïôÂÆ§", "ji√†osh√¨", "classroom", "üë©‚Äçüè´", {cn: "Âú®ÊïôÂÆ§", py: "z√†i ji√†o sh√¨", en: "In the classroom"}],
        ["ÊàøÈó¥", "f√°ngjiƒÅn", "room", "üè†", {cn: "ËøõÊàøÈó¥", py: "j√¨n f√°ng jiƒÅn", en: "Enter the room"}],
        ["Ë∑Ø", "l√π", "road", "üõ£Ô∏è", {cn: "Âú®Â§ßË∑Ø‰∏ä", py: "z√†i d√† l√π sh√†ng", en: "On the big road"}],
        ["Â∑¶Ëæπ", "zu«íbiƒÅn", "left", "‚¨ÖÔ∏è", {cn: "ÂæÄÂ∑¶ËæπÁúã", py: "w«éng zu«í biƒÅn k√†n", en: "Look to the left"}],
        ["Âè≥Ëæπ", "y√≤ubiƒÅn", "right", "‚û°Ô∏è", {cn: "Âú®Âè≥Ëæπ", py: "z√†i y√≤u biƒÅn", en: "On the right"}],
        ["Â§ñ", "w√†i", "outside", "üèûÔ∏è", {cn: "Âú®Â§ñÈù¢", py: "z√†i w√†i mian", en: "Outside"}],
        ["ÊóÅËæπ", "p√°ngbiƒÅn", "beside", "üï¥Ô∏è", {cn: "Âú®ÊàëÊóÅËæπ", py: "z√†i w«í p√°ng biƒÅn", en: "Next to me"}],
        ["‰∏Ä‰∏ã", "y√≠xi√†", "a bit", "‚è±Ô∏è", {cn: "Á≠â‰∏Ä‰∏ã", py: "dƒõng y√≠ xi√†", en: "Wait a moment"}],
        ["Êó©‰∏ä", "z«éoshang", "morning", "üåÖ", {cn: "Êó©‰∏äÂ•Ω", py: "z«éo shang h«éo", en: "Good morning"}],
        ["Êôö‰∏ä", "w«énshang", "evening", "üåÉ", {cn: "Êôö‰∏äËßÅ", py: "w«én shang ji√†n", en: "See you tonight"}],
        ["Â∞èÊó∂", "xi«éosh√≠", "hour", "‚è≤Ô∏è", {cn: "‰∏§Â∞èÊó∂", py: "li«éng xi«éo sh√≠", en: "Two hours"}],
        ["Êó∂Èó¥", "sh√≠jiƒÅn", "time", "‚è≥", {cn: "Ê≤°Êó∂Èó¥", py: "m√©i sh√≠ jiƒÅn", en: "No time"}],
        ["ÂéªÂπ¥", "q√πni√°n", "last year", "üìÖ", {cn: "ÂéªÂπ¥ÂçÅÂ≤Å", py: "q√π ni√°n sh√≠ su√¨", en: "Was ten last year"}],
        ["Êó•", "r√¨", "day", "‚òÄÔ∏è", {cn: "ÁîüÊó•Âø´‰πê", py: "shƒìng r√¨ ku√†i l√®", en: "Happy birthday"}],
        ["ÁîüÊó•", "shƒìngr√¨", "birthday", "üéÇ", {cn: "ÊàëÁöÑÁîüÊó•", py: "w«í de shƒìng r√¨", en: "My birthday"}],
        ["Âì•Âì•", "gƒìge", "elder brother", "üë¶", {cn: "‰ªñÊòØÊàëÂì•", py: "tƒÅ sh√¨ w«í gƒì", en: "He is my brother"}],
        ["ÂßêÂßê", "jiƒõjie", "elder sister", "üëß", {cn: "ÂßêÂßêÊºÇ‰∫Æ", py: "jiƒõ jie pi√†o liang", en: "Sister is pretty"}],
        ["ÂºüÂºü", "d√¨di", "younger brother", "üë∂", {cn: "ÂºüÂºüÁà±Á¨ë", py: "d√¨ di √†i xi√†o", en: "Little brother smiles"}],
        ["Â¶πÂ¶π", "m√®imei", "younger sister", "üëß", {cn: "ÊàëÊúâÂ¶πÂ¶π", py: "w«í y«íu m√®i mei", en: "I have a sister"}],
        ["‰∏àÂ§´", "zh√†ngfu", "husband", "üë®", {cn: "Â•π‰∏àÂ§´", py: "tƒÅ zh√†ng fu", en: "Her husband"}],
        ["Â¶ªÂ≠ê", "qƒ´zi", "wife", "üë©", {cn: "ÊàëÂ¶ªÂ≠ê", py: "w«í qƒ´ zi", en: "My wife"}],
        ["Â≠©Â≠ê", "h√°izi", "child", "üë∂", {cn: "Â∞èÂ≠©Â≠ê", py: "xi«éo h√°i zi", en: "Small child"}],
        ["Áî∑‰∫∫", "n√°nr√©n", "man", "üë®", {cn: "ÈÇ£‰∏™Áî∑‰∫∫", py: "n√† g√® n√°n r√©n", en: "That man"}],
        ["Â•≥‰∫∫", "n«ör√©n", "woman", "üë©", {cn: "ÈÇ£‰∏™Â•≥‰∫∫", py: "n√† g√® n«ö r√©n", en: "That woman"}],
        ["ÊúçÂä°Âëò", "f√∫w√πyu√°n", "waiter", "üíÅ", {cn: "ÊúçÂä°ÂëòÂ•Ω", py: "f√∫ w√π yu√°n h«éo", en: "Hello waiter"}],
        ["È±º", "y√∫", "fish", "üêü", {cn: "Áà±ÂêÉÈ±º", py: "√†i chƒ´ y√∫", en: "Love eating fish"}],
        ["ÁæäËÇâ", "y√°ngr√≤u", "mutton", "üçñ", {cn: "‰π∞ÁæäËÇâ", py: "m«éi y√°ng r√≤u", en: "Buy mutton"}],
        ["ÁâõÂ•∂", "ni√∫n«éi", "milk", "ü•õ", {cn: "ÂñùÁâõÂ•∂", py: "hƒì ni√∫ n«éi", en: "Drink milk"}],
        ["È∏°Ëõã", "jƒ´d√†n", "egg", "ü•ö", {cn: "ÂêÉÈ∏°Ëõã", py: "chƒ´ jƒ´ d√†n", en: "Eat eggs"}],
        ["Ë•øÁìú", "xƒ´guƒÅ", "watermelon", "üçâ", {cn: "Â§ßË•øÁìú", py: "d√† xƒ´ guƒÅ", en: "Big watermelon"}],
        ["ÂíñÂï°", "kƒÅfƒìi", "coffee", "‚òï", {cn: "ÂñùÂíñÂï°", py: "hƒì kƒÅ fƒìi", en: "Drink coffee"}],
        ["Èõ™", "xuƒõ", "snow", "‚ùÑÔ∏è", {cn: "‰∏ãÈõ™‰∫Ü", py: "xi√† xuƒõ le", en: "It's snowing"}],
        ["ËçØ", "y√†o", "medicine", "üíä", {cn: "ÂêÉËçØ‰∫Ü", py: "chƒ´ y√†o le", en: "Took medicine"}],
        ["ÊâãÊú∫", "sh«íujƒ´", "phone", "üì±", {cn: "Êñ∞ÊâãÊú∫", py: "xƒ´n sh«íu jƒ´", en: "New phone"}],
        ["ÊâãË°®", "sh«íubi«éo", "watch", "‚åö", {cn: "ÁúãÊâãË°®", py: "k√†n sh«íu bi«éo", en: "Look at watch"}],
        ["ÁúºÁùõ", "y«énjƒ´ng", "eye", "üëÄ", {cn: "Â§ßÁúºÁùõ", py: "d√† y«én jing", en: "Big eyes"}],
        ["Ë∫´‰Ωì", "shƒìnt«ê", "body", "üí™", {cn: "Ë∫´‰ΩìÂ•Ω", py: "shƒìn t«ê h«éo", en: "Good health"}],
        ["ÂÖ¨ÂÖ±Ê±ΩËΩ¶", "g≈çngg√≤ngq√¨chƒì", "bus", "üöå", {cn: "ÂùêÂÖ¨ËΩ¶", py: "zu√≤ g≈çng chƒì", en: "Take the bus"}],
        ["Êä•Á∫∏", "b√†ozh«ê", "newspaper", "üì∞", {cn: "ÁúãÊä•Á∫∏", py: "k√†n b√†o zh«ê", en: "Read newspaper"}],
        ["Èó®", "m√©n", "door", "üö™", {cn: "ÂºÄÈó®Âêß", py: "kƒÅi m√©n ba", en: "Open the door"}],
        ["È¢ò", "t√≠", "question", "üìù", {cn: "ËøôÈÅìÈ¢ò", py: "zh√® d√†o t√≠", en: "This question"}],
        ["ËØæ", "k√®", "lesson", "üìñ", {cn: "‰∏äËØæ‰∫Ü", py: "sh√†ng k√® le", en: "Class starts"}],
        ["Âßì", "x√¨ng", "surname", "üè∑Ô∏è", {cn: "‰ªñÂßìÁéã", py: "tƒÅ x√¨ng w√°ng", en: "His surname is Wang"}],
        ["ÈóÆÈ¢ò", "w√®nt√≠", "problem", "‚ùì", {cn: "Ê≤°ÈóÆÈ¢ò", py: "m√©i w√®n t√≠", en: "No problem"}],
        ["‰∫ãÊÉÖ", "sh√¨qing", "matter", "üíº", {cn: "ÈÇ£‰ª∂‰∫ãÊÉÖ", py: "n√† ji√†n sh√¨ qing", en: "That matter"}],
        ["ËÄÉËØï", "k«éosh√¨", "exam", "‚úçÔ∏è", {cn: "ÂéªËÄÉËØï", py: "q√π k«éo sh√¨", en: "Go to the exam"}],
        ["Á•®", "pi√†o", "ticket", "üéüÔ∏è", {cn: "‰π∞Á•®Âéª", py: "m«éi pi√†o q√π", en: "Buy tickets"}],
        ["ÊÑèÊÄù", "y√¨si", "meaning", "üí°", {cn: "ÊúâÊÑèÊÄù", py: "y«íu y√¨ si", en: "Interesting"}],
        ["È¢úËâ≤", "y√°ns√®", "color", "üé®", {cn: "Á∫¢È¢úËâ≤", py: "h√≥ng y√°n s√®", en: "Red color"}],
        ["ÈìÖÁ¨î", "qi√°nb«ê", "pencil", "‚úèÔ∏è", {cn: "Áî®ÈìÖÁ¨î", py: "y√≤ng qi√°n b«ê", en: "Use a pencil"}],
        ["Èù¢Êù°", "mi√†nti√°o", "noodle", "üçú", {cn: "ÂêÉÈù¢Êù°", py: "chƒ´ mi√†n ti√°o", en: "Eat noodles"}],
        ["ÁÅ´ËΩ¶Á´ô", "hu«íchƒìzh√†n", "train station", "üöâ", {cn: "ÂéªÁÅ´ËΩ¶Á´ô", py: "q√π hu«í chƒì zh√†n", en: "Go to station"}],
        ["ÂÖ¨Âè∏", "g≈çngsƒ´", "company", "üè¢", {cn: "Â§ßÂÖ¨Âè∏", py: "d√† g≈çng sƒ´", en: "Big company"}],
        ["ÂÆæÈ¶Ü", "bƒ´nggu«én", "hotel", "üè®", {cn: "‰ΩèÂÆæÈ¶Ü", py: "zh√π bƒ´ng gu«én", en: "Stay in hotel"}],
        ["ËØ¥ËØù", "shu≈çhu√†", "speak", "üí¨", {cn: "Âà´ËØ¥ËØù", py: "bi√© shu≈ç hu√†", en: "Don't speak"}],
        ["Âçñ", "m√†i", "sell", "üí∞", {cn: "Âçñ‰∏úË•ø", py: "m√†i d≈çng xi", en: "Sell things"}],
        ["ÈóÆ", "w√®n", "ask", "‚ùì", {cn: "ÈóÆ‰∏Ä‰∏ã", py: "w√®n y√≠ xi√†", en: "Ask a bit"}],
        ["Ëµ∞", "z«íu", "walk", "üö∂", {cn: "Ëµ∞Âø´ÁÇπ", py: "z«íu ku√†i di«én", en: "Walk faster"}],
        ["Ëøõ", "j√¨n", "enter", "üö™", {cn: "ËØ∑ËøõÂêß", py: "q«êng j√¨n ba", en: "Please come in"}],
        ["Âá∫", "ch≈´", "exit", "üèÉ", {cn: "Âá∫Âéª‰∫Ü", py: "ch≈´ q√π le", en: "Went out"}],
        ["Ë∑ëÊ≠•", "p«éob√π", "run", "üèÉ", {cn: "ÂéªË∑ëÊ≠•", py: "q√π p«éo b√π", en: "Go running"}],
        ["Âà∞", "d√†o", "arrive", "üìç", {cn: "ÊàëÂà∞‰∫Ü", py: "w«í d√†o le", en: "I arrived"}],
        ["Á©ø", "chuƒÅn", "wear", "üëï", {cn: "Á©øË°£Êúç", py: "chuƒÅn yƒ´ fu", en: "Wear clothes"}],
        ["Ê¥ó", "x«ê", "wash", "üßº", {cn: "Ê¥óÊ¥óÊâã", py: "x«ê x«ê sh«íu", en: "Wash hands"}],
        ["Áªô", "gƒõi", "give", "üéÅ", {cn: "Áªô‰Ω†Èí±", py: "gƒõi n«ê qi√°n", en: "Give you money"}],
        ["Êâæ", "zh«éo", "find", "üîç", {cn: "ÊâæÊúãÂèã", py: "zh«éo p√©ng you", en: "Find friends"}],
        ["ÊáÇ", "d«íng", "understand", "üí°", {cn: "Âê¨ÊáÇ‰∫Ü", py: "tƒ´ng d«íng le", en: "Understood"}],
        ["Á¨ë", "xi√†o", "smile", "üòä", {cn: "Á¨ë‰∏ÄÁ¨ë", py: "xi√†o y√≠ xi√†o", en: "Smile"}],
        ["ÂëäËØâ", "g√†os√π", "tell", "üó£Ô∏è", {cn: "ÂëäËØâÊàë", py: "g√†o s√π w«í", en: "Tell me"}],
        ["ÂáÜÂ§á", "zh«înb√®i", "prepare", "üìù", {cn: "ÂáÜÂ§áÂ•Ω", py: "zh«în b√®i h«éo", en: "Ready"}],
        ["ÂºÄÂßã", "kƒÅish«ê", "begin", "‚ñ∂Ô∏è", {cn: "ÂºÄÂßã‰∫Ü", py: "kƒÅi sh«ê le", en: "Started"}],
        ["‰ªãÁªç", "ji√®sh√†o", "introduce", "ü§ù", {cn: "‰ªãÁªç‰∏ã", py: "ji√® sh√†o xi√†", en: "Introduce bit"}],
        ["Â∏ÆÂä©", "bƒÅngzh√π", "help", "üÜò", {cn: "Â§öÂ∏ÆÂä©", py: "du≈ç bƒÅng zh√π", en: "Help more"}],
        ["Áé©", "w√°n", "play", "üéÆ", {cn: "Â•ΩÁé©Âêó", py: "h«éo w√°n ma", en: "Is it fun"}],
        ["ÈÄÅ", "s√≤ng", "send", "üéÅ", {cn: "ÈÄÅÁ§ºÁâ©", py: "s√≤ng l«ê w√π", en: "Give a gift"}],
        ["Á≠â", "dƒõng", "wait", "‚è≥", {cn: "Á≠â‰∏Ä‰∏ã", py: "dƒõng y√≠ xi√†", en: "Wait a moment"}],
        ["ËÆ©", "r√†ng", "let", "üÜó", {cn: "ËÆ©‰ªñÂéª", py: "r√†ng tƒÅ q√π", en: "Let him go"}],
        ["Ëµ∑Â∫ä", "q«êchu√°ng", "get up", "‚è∞", {cn: "Ëµ∑Â∫ä‰∫Ü", py: "q«ê chu√°ng le", en: "Got up"}],
        ["Âî±Ê≠å", "ch√†nggƒì", "sing", "üé§", {cn: "Áà±Âî±Ê≠å", py: "√†i ch√†ng gƒì", en: "Love singing"}],
        ["Ë∑≥Ëàû", "ti√†ow«î", "dance", "üíÉ", {cn: "ÂéªË∑≥Ëàû", py: "q√π ti√†o w«î", en: "Go dancing"}],
        ["ÊóÖÊ∏∏", "l«öy√≥u", "travel", "üß≥", {cn: "ÂéªÊóÖÊ∏∏", py: "q√π l«ö y√≥u", en: "Go traveling"}],
        ["‰∏äÁè≠", "sh√†ngbƒÅn", "work", "üíº", {cn: "Âéª‰∏äÁè≠", py: "q√π sh√†ng bƒÅn", en: "Go to work"}],
        ["ÁîüÁóÖ", "shƒìngb√¨ng", "sick", "ü§í", {cn: "ÁîüÁóÖ‰∫Ü", py: "shƒìng b√¨ng le", en: "Got sick"}],
        ["‰ºëÊÅØ", "xi≈´xi", "rest", "üõãÔ∏è", {cn: "Â§ö‰ºëÊÅØ", py: "du≈ç xi≈´ xi", en: "Rest more"}],
        ["ËøêÂä®", "y√πnd√≤ng", "exercise", "üèÉ", {cn: "Áà±ËøêÂä®", py: "√†i y√πn d√≤ng", en: "Love exercise"}],
        ["Ê∏∏Ê≥≥", "y√≥uy«íng", "swim", "üèä", {cn: "ÂéªÊ∏∏Ê≥≥", py: "q√π y√≥u y«íng", en: "Go swimming"}],
        ["Ë∏¢Ë∂≥ÁêÉ", "tƒ´z√∫qi√∫", "football", "‚öΩ", {cn: "Ë∏¢Ë∂≥ÁêÉ", py: "tƒ´ z√∫ qi√∫", en: "Play soccer"}],
        ["ÊâìÁØÆÁêÉ", "d«él√°nqi√∫", "basketball", "üèÄ", {cn: "ÊâìÁØÆÁêÉ", py: "d«é l√°n qi√∫", en: "Play basketball"}],
        ["ÂÆå", "w√°n", "finish", "üèÅ", {cn: "ÂÅöÂÆå‰∫Ü", py: "zu√≤ w√°n le", en: "Finished"}],
        ["ËßâÂæó", "ju√©d√©", "feel", "ü§î", {cn: "ÊàëÁúüËßâÂæó", py: "w«í zhƒìn ju√© de", en: "I really feel"}],
        ["Áü•ÈÅì", "zhƒ´dao", "know", "üí°", {cn: "ÊàëÁü•ÈÅì", py: "w«í zhƒ´ d√†o", en: "I know"}],
        ["Â∏åÊúõ", "xƒ´w√†ng", "hope", "üåü", {cn: "Â§ßÂ∏åÊúõ", py: "d√† xƒ´ w√†ng", en: "Great hope"}],
        ["ÂèØ‰ª•", "kƒõy«ê", "can", "‚úÖ", {cn: "ÂèØ‰ª•Âêó", py: "kƒõ y«ê ma", en: "Is it okay"}],
        ["Ë¶Å", "y√†o", "want", "üí™", {cn: "ÊàëË¶Å‰π∞", py: "w«í y√†o m«éi", en: "I want to buy"}],
        ["ÂèØËÉΩ", "kƒõn√©ng", "maybe", "‚ùì", {cn: "‰∏çÂèØËÉΩ", py: "b√π kƒõ n√©ng", en: "Impossible"}],
        ["È´ò", "gƒÅo", "tall", "üìè", {cn: "‰ªñÂæàÈ´ò", py: "tƒÅ hƒõn gƒÅo", en: "He is tall"}],
        ["Á∫¢", "h√≥ng", "red", "üî¥", {cn: "Á∫¢ËãπÊûú", py: "h√≥ng p√≠ng gu«í", en: "Red apple"}],
        ["ÁôΩ", "b√°i", "white", "‚ö™", {cn: "ÁôΩË°£Êúç", py: "b√°i yƒ´ fu", en: "White clothes"}],
        ["Èªë", "hƒìi", "black", "‚ö´", {cn: "ÈªëÈ¢úËâ≤", py: "hƒìi y√°n s√®", en: "Black color"}],
        ["Âøô", "m√°ng", "busy", "üèÉ", {cn: "Â§™Âøô‰∫Ü", py: "t√†i m√°ng le", en: "Too busy"}],
        ["Âø´", "ku√†i", "fast", "üöÄ", {cn: "ÁúüÂø´Âïä", py: "zhƒìn ku√†i a", en: "Really fast"}],
        ["ÊÖ¢", "m√†n", "slow", "üê¢", {cn: "Ëµ∞ÊÖ¢ÁÇπ", py: "z«íu m√°n di«én", en: "Walk slower"}],
        ["Ëøú", "yu«én", "far", "üõ£Ô∏è", {cn: "‰∏çËøú‰∫Ü", py: "b√π yu«én le", en: "Not far now"}],
        ["Ëøë", "j√¨n", "near", "üè†", {cn: "ÂæàËøëÁöÑ", py: "hƒõn j√¨n de", en: "Very near"}],
        ["Â•ΩÂêÉ", "h«éochƒ´", "tasty", "üòã", {cn: "ÁúüÂ•ΩÂêÉ", py: "zhƒìn h«éo chƒ´", en: "Really tasty"}],
        ["Á¥Ø", "l√®i", "tired", "üò¥", {cn: "ÊàëÂæàÁ¥Ø", py: "w«í hƒõn l√®i", en: "I am tired"}],
        ["Èïø", "ch√°ng", "long", "üìè", {cn: "ÈïøÂ§¥Âèë", py: "ch√°ng t√≥u fa", en: "Long hair"}],
        ["Êñ∞", "xƒ´n", "new", "‚ú®", {cn: "Êñ∞ÊâãÊú∫", py: "xƒ´n sh«íu jƒ´", en: "New phone"}],
        ["Ë¥µ", "gu√¨", "expensive", "üí∞", {cn: "Â§™Ë¥µ‰∫Ü", py: "t√†i gu√¨ le", en: "Too expensive"}],
        ["‰æøÂÆú", "pi√°nyi", "cheap", "üè∑Ô∏è", {cn: "Âæà‰æøÂÆú", py: "hƒõn pi√°n yi", en: "Very cheap"}],
        ["Êô¥", "q√≠ng", "sunny", "‚òÄÔ∏è", {cn: "Êô¥Â§©Â•Ω", py: "q√≠ng tiƒÅn h«éo", en: "Sunny day is good"}],
        ["Èò¥", "yƒ´n", "cloudy", "‚òÅÔ∏è", {cn: "Èò¥Â§©‰∫Ü", py: "yƒ´n tiƒÅn le", en: "It's cloudy"}],
        ["Èîô", "cu√≤", "wrong", "‚ùå", {cn: "Ê≤°ÈîôÁöÑ", py: "m√©i cu√≤ de", en: "No mistake"}],
        ["Âø´‰πê", "ku√†il√®", "happy", "üòÑ", {cn: "Âø´‰πêÂ≠¶", py: "ku√†i l√® xu√©", en: "Happy learning"}],
        ["ÂØπ", "du√¨", "right", "‚úÖ", {cn: "ËØ¥ÂæóÂØπ", py: "shu≈ç de du√¨", en: "Correct"}]
    ];

    let currentMode = 'study', currentIndex = 0, score = 0, timer = null;
    let mistakes = [];

    const instructions = {
        study: "üìñ Learn: 1:1 aligned pinyin and audio.",
        review: "üîÑ Review: Reveal sentences with the eye icon.",
        quiz: "‚ö° Quiz: Test your HSK 2 knowledge.",
        rush: "üî• Rush: 30 seconds to answer as many as you can!",
        mistakes: "‚ùå Error: Focus on the words you missed.",
        list: "üìú List: Click any word to learn its card."
    };

    // Èü≥ÊïàÂáΩÊï∞
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    function playSound(type) {
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        if (type === 'correct') {
            osc.frequency.setValueAtTime(523.25, audioCtx.currentTime); // C5
            osc.frequency.exponentialRampToValueAtTime(880, audioCtx.currentTime + 0.1);
        } else {
            osc.frequency.setValueAtTime(220, audioCtx.currentTime); // A3
            osc.frequency.exponentialRampToValueAtTime(110, audioCtx.currentTime + 0.2);
        }
        osc.start();
        gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
        osc.stop(audioCtx.currentTime + 0.3);
    }

    function enterApp() {
        document.getElementById('cover-page').style.opacity = '0';
        setTimeout(() => { document.getElementById('cover-page').style.visibility = 'hidden'; }, 800);
        setMode('study');
    }

    function changeMode(m) {
        currentIndex = 0;
        setMode(m);
    }

    function setMode(m) {
        currentMode = m; clearInterval(timer);
        document.querySelectorAll('.nav-btns button, #btn-list').forEach(b => b.classList.remove('active-mode'));
        const activeBtn = document.getElementById('btn-' + m);
        if(activeBtn) activeBtn.classList.add('active-mode');
        
        document.getElementById('mode-instruction').innerText = instructions[m] || "";
        document.getElementById('timer-display').classList.add('hidden');
        
        if(m === 'list') {
            document.getElementById('main-ui').classList.add('hidden');
            document.getElementById('scroll-view').style.display = 'block';
            renderList();
        } else {
            document.getElementById('main-ui').classList.remove('hidden');
            document.getElementById('scroll-view').style.display = 'none';
            if (m === 'rush') startRush();
            render();
        }
    }

    function startRush() {
        let timeLeft = 30; score = 0; currentIndex = Math.floor(Math.random() * database.length);
        document.getElementById('score-val').innerText = "0";
        const display = document.getElementById('timer-display');
        display.classList.remove('hidden');
        timer = setInterval(() => {
            timeLeft--;
            display.innerText = `00:${timeLeft < 10 ? '0'+timeLeft : timeLeft}`;
            if (timeLeft <= 0) { clearInterval(timer); alert("Time up! Score: " + score); setMode('study'); }
        }, 1000);
    }

    function generate1to1Html(text, pinyinStr) {
        const chars = text.split(''); const pys = pinyinStr.split(' ');
        let html = '<div class="sentence-container">';
        let pyIdx = 0;
        chars.forEach(c => {
            if(/[\u4e00-\u9fa5]/.test(c)) {
                html += `<div class="word-unit"><div class="py-text">${pys[pyIdx] || ''}</div><div class="zh-text">${c}</div></div>`;
                pyIdx++;
            } else if(c !== ' ') {
                html += `<div class="word-unit"><div class="py-text"></div><div class="zh-text">${c}</div></div>`;
            }
        });
        html += '</div>';
        return html;
    }

    function render() {
        const display = document.getElementById('display-area');
        const interaction = document.getElementById('interaction-area');
        const hint = document.getElementById('hint-box');
        let activeList = (currentMode === 'mistakes') ? mistakes : database;
        
        if (activeList.length === 0 && currentMode === 'mistakes') {
            display.innerHTML = "<h2>No errors yet!</h2>";
            interaction.innerHTML = `<button class="option-btn" onclick="setMode('study')">Back to Learn</button>`;
            return;
        }

        const item = activeList[currentIndex];
        document.getElementById('emoji-display').innerText = item[3];
        interaction.innerHTML = ""; 
        hint.className = "hidden";

        if(currentMode === 'study' || currentMode === 'review') {
            display.innerHTML = generate1to1Html(item[0], item[1]) + `<div class="eng-translation">${item[2]}</div>`;
            hint.innerHTML = `<div onclick="speakText('${item[4].cn}')" style="cursor:pointer;">${generate1to1Html(item[4].cn, item[4].py)}</div><div style="font-size:18px; color:#666; font-style:italic; margin-top:5px;">${item[4].en}</div>`;
            
            if(currentMode === 'study') {
                hint.classList.remove('hidden');
                speakItem(false);
            } else {
                interaction.innerHTML = `<button class="option-btn" onclick="document.getElementById('hint-box').classList.toggle('hidden')">üëÅÔ∏è Show Example</button>`;
            }
            interaction.innerHTML += `<button class="option-btn" onclick="nextCard()" style="background:var(--primary); color:white;">Next ‚Üí</button>`;
        } else {
            const isEnToCn = Math.random() > 0.5;
            let quest = isEnToCn ? item[2] : item[0];
            let ans = isEnToCn ? item[0] : item[2];
            display.innerHTML = `<h2 style="font-size:42px; color:var(--primary);">${quest}</h2>`;
            let choices = [ans];
            while(choices.length < 4) {
                let r = database[Math.floor(Math.random()*database.length)];
                let val = isEnToCn ? r[0] : r[2];
                if(!choices.includes(val)) choices.push(val);
            }
            choices.sort(() => Math.random() - 0.5);
            choices.forEach(c => {
                const b = document.createElement('button'); b.className = 'option-btn'; b.innerText = c;
                b.onclick = () => {
                    if(c === ans) {
                        playSound('correct');
                        score += 10; document.getElementById('score-val').innerText = score;
                        b.style.background = "#4caf50"; b.style.color = "white"; 
                        setTimeout(nextCard, 500);
                    } else { 
                        playSound('wrong');
                        b.style.background = "#f44336"; b.style.color = "white";
                        if (!mistakes.includes(item)) mistakes.push(item);
                    }
                };
                interaction.appendChild(b);
            });
        }
    }

    function nextCard() {
        if (currentMode === 'rush') {
            currentIndex = Math.floor(Math.random() * database.length);
        } else {
            let activeList = (currentMode === 'mistakes') ? mistakes : database;
            currentIndex = (currentIndex + 1) % activeList.length;
        }
        render();
    }

    function renderList() {
        const view = document.getElementById('scroll-view');
        view.innerHTML = "<h2>üìú HSK 2 Master List</h2><p style='color:#666;'>Tap any word to view its card.</p>";
        database.forEach((it, idx) => {
            const r = document.createElement('div'); r.className = 'list-row';
            r.innerHTML = `<div style="font-size: 18px; width: 40px; color: #999;">${idx+1}</div>
                <div style="font-size: 30px; margin-right: 20px;">${it[3]}</div>
                <div style="flex: 1;"><span style="font-size:24px; font-weight:bold;">${it[0]}</span> 
                <span style="color:var(--pinyin); font-weight:bold; margin-left:10px;">[ ${it[1]} ]</span> 
                <div style="color:#666;">${it[2]}</div></div>`;
            r.onclick = () => {
                currentIndex = idx;
                setMode('study');
            };
            view.appendChild(r);
        });
    }

    function speakText(text) {
        window.speechSynthesis.cancel();
        const m = new SpeechSynthesisUtterance(text);
        m.lang = 'zh-CN'; m.rate = 0.8;
        window.speechSynthesis.speak(m);
    }

    function speakItem(withEx) {
        const item = database[currentIndex];
        speakText(item[0]);
        if(withEx) setTimeout(() => speakText(item[4].cn), 1000);
    }
</script>
</body>
</html>